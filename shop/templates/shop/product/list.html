{% extends "shop/base.html" %}
{% load static %}
{% block title %}
    {% if category %}{{ category.name }}{% else %}Наклейки{% endif %}
{% endblock %}
{% block content %}
    <div class="md:hidden">
        {% with total_items=cart|length %}
            {% if cart|length > 0 %}
                <a href="{% url "cart:cart_detail" %}"
                   class="z-50 fixed bottom-6 right-6 rounded-full px-6 py-1 bg-red-400 border text-lg md:text-sm text-white font-light">
                    {{ cart.get_total_price }} ₽
                </a>
            {% endif %}
        {% endwith %}
    </div>
    <div class="mt-6">
        <div class="" id="categories">
            <ul class="flex justify-center">
                <li class="mx-6">
                    <a class="text-lg" {% if not category %} class="text-red-400 bg-yellow-50"{% endif %}
                       href="{% url "shop:product_list" %}">
                        <img class="w-8 md:w-10" src="/media/all_cat.png" alt="">
                    </a>
                </li>
                {% for c in categories %}
                    <li class="mx-4">
                        <a {% if category.slug == c.slug %}class="text-red-400"{% endif %}
                           href="{{ c.get_absolute_url }}">
                            {% if c.icon %}
                                <img class="w-8 md:w-10" src="{{ c.icon.url }}" alt="Категория">
                            {% else %}
                                {{ c.name }}
                            {% endif %}
                        </a>
                    </li>
                {% endfor %}
            </ul>
            <h2 class="text-3xl text-center mt-4">
                {% if category %}{{ category.name }}{% else %}Все наклейки{% endif %}
            </h2>
        </div>
        <!-- Товары -->
        <section class="container px-6 py-4 mx-auto">
            <div class="grid gap-4 mb-8 md:grid-cols-2 lg:grid-cols-4">
                {% for product in products %}
                    <!-- Карточка товара -->
                    <div class="flex h-28 w-full md:w-auto relative bg-white border border-gray-100 rounded shadow-md dark:bg-gray-800">
                        <div class="m-2 my-auto rounded-full flex-none items-center">
                            <img
                                    alt="{{ product.name }}"
                                    class="h-24 object-contain"
                                    loading="lazy"
                                    src="
                                        {% if product.image %}{{ product.image.url }}
                                        {% else %}{% static "img/no_image.png" %}
                                        {% endif %}">
                        </div>
                        <div class="flex-grow mr-4 place-content-between">
                            <p class="m-1 mt-2 text-lg font-light md:text-md leading-tight text-gray-900">{{ product.name }}</p>
                            <p class="ml-1 text-sm text-gray-600">{{ product.category }}</p>
                            <form class="flex absolute bottom-3 right-1" action="{% url "cart:cart_add" product.id %}" method="post">
                                <div class="flex justify-center px-2 h-7 rounded-full shadow border border-gray-50 items-center align-items-center">
                                    <button class="h-4 w-4" type="button"
                                            onclick="this.nextElementSibling.stepDown(); this.nextElementSibling.onchange();">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none"
                                             viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M18 12H6"></path>
                                        </svg>
                                    </button>
                                    <input class=" text-sm rounded-none w-8 text-center text-sm appearance-none bg-white"
                                           name="quantity" type="number" min="25" value="25" step="25" readonly>
                                    <button class="h-4 w-4" type="button"
                                            onclick="this.previousElementSibling.stepUp(); this.previousElementSibling.onchange();">
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none"
                                             viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                        </svg>
                                    </button>
                                </div>
                                {{ cart_product_form }}
                                {% csrf_token %}
                                <button class="flex px-2 mx-2 shadow rounded font-normal justify-center align-items-center"
                                        type="submit">Добавить
                                </button>
                            </form>
                            </p>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>
    </div>
{% endblock %}
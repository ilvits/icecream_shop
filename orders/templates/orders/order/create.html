{% extends "shop/base.html" %}
{% load widget_tweaks %}
{% load static %}

{% block title %}Оформление заказа{% endblock %}

{% block content %}
  <h1 class="text-3xl m-4 font-normal text-center my-8">Оформление заказа</h1>
   <div class="flex justify-center items-start">
    <div class="bg-white rounded-lg shadow-lg border-t border-gray-50 w-5/6 md:max-w-lg">
        <form action="." method="POST" class="px-8 pt-6 pb-8 rounded">
          {% csrf_token %}
          {% for hidden in form.hidden_fields %}
          {{ hidden }}
          {% endfor %}
          <div class="mb-5">
            <p class="m-4">Получатель: {{ user.first_name }} {{ user.last_name }}</p>
          </div>
          <div class="mb-5">
            <p class="m-4">Email: {{ user.email }}</p>
          </div>
          <div class="mb-5">
            <select class="hidden" name="owner" required="" id="id_owner">
              <option value="{{ user.id }}" selected>{{ user.username }}</option>
            </select>
          </div>
          <button class="mt-4 bg-white border-t border-gray-100 hover:bg-gray-100 w-full p-4 text-sm text-black uppercase font-bold tracking-wider shadow-md rounded-lg" type="submit">
            Сделать заказ
          </button>
        </form>
      </div>

      <div class="w-96 rounded border ml-16 hidden md:block">
        <h3 class="text-center font-normal text-2xl py-4">Корзина</h3>
        <div class="w-full mx-auto px-4">
        {% for category in categories %}
          {% if category.items.length > 0 %}
          fsfsf
          {% endif %}
        {% endfor %}
          {% for item in cart %}
          {% with product=item.product %}
          <!-- Карточка товара -->
          <div class='relative flex bg-white border-b pt-2'>
            <div class='flex-no-shrink px-2 items-align-center'>
              <img alt='{{ product.name }}' class='w-14 block mx-auto' src='
                        {% if product.image %}
                            {{ product.image.url }}
                        {% else %}
                            {% static "img/no_image.png" %}
                        {% endif %}'>
            </div>
            <div class='flex-1 card-block relative'>
              <div class="">
                <h4 class='font-light text-xl md:text-sm mt-2 mr-2'>{{ product.name }}</h4>
                <p class='text-gray-500 text-sm'>{{ product.category }}</p>
                <p class="text-sm text-gray-600 block px-2 pb-1 font-extralight text-right">
                  <span class="text-black font-normal">{{ item.quantity }} шт.</span> | {{ item.total_price }}₽
                </p>
              </div>
            </div>
          </div>
          {% endwith %}
          {% endfor %}
          <span class="w-full block text-right text-xl text-black mt-4">Общая сумма: <span class="font-normal">{{ cart.get_total_price }}₽</span></span>
          <div class="flex justify-between w-full pt-2">
          </div>
        </div>
      </div>
    </div>
{% endblock %}